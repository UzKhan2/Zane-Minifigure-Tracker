<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Zane Minifigure Tracker</title>

    <style>
      body {
        font-family: Arial, sans-serif;
        background: #f5f5f5;
        padding: 20px;
      }

      h1 {
        text-align: center;
      }

      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, 150px);
        gap: 12px;
        justify-content: center;
        margin-top: 20px;
      }

      /* ---------- CARD ---------- */

      .card {
        height: 200px;
        background: white;
        border-radius: 12px;
        padding: 12px;
        text-align: center;
        cursor: pointer;
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        transition: 0.2s;
        user-select: none;
        display: flex;
        flex-direction: column;
        align-items: center;

        position: relative;
        overflow: hidden;
      }

      .card:hover {
        transform: scale(1.05);
      }

      .owned {
        background: #c8f7c5;
        text-decoration: line-through;
      }

      /* ---------- FRONT (image) ---------- */

      .front,
      .back {
        position: absolute;
        inset: 0;

        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;

        padding: 10px;
        text-align: center;
      }

      .front {
        gap: 6px;
      }

      .minifig-img {
        width: 100px;
        height: auto;
      }

      .figure-name {
        font-weight: bold;
        font-size: 0.9em;

        overflow: hidden;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
      }

      /* ---------- BACK (info) ---------- */

      .back {
        display: none;
        font-size: 0.85em;
        gap: 4px;
      }

      .card:hover .front {
        display: none;
      }

      .card:hover .back {
        display: flex;
      }

      .links {
        display: flex;
        flex-direction: column;
        gap: 4px;
        margin-top: 6px;
      }

      .links a {
        color: #007bff;
        text-decoration: none;
        font-size: 1em;
      }

      .links a:hover {
        text-decoration: underline;
      }

      .count {
        text-align: center;
        font-weight: bold;
        margin-top: 10px;
      }
    </style>
  </head>

  <body>
    <h1>Zane Minifigure Tracker</h1>
    <div class="count" id="count"></div>
    <div class="grid" id="grid"></div>

    <script>
      let figures = [];
      let owned = JSON.parse(localStorage.getItem("ownedZanes") || {});
      const grid = document.getElementById("grid");

      function save() {
        localStorage.setItem("ownedZanes", JSON.stringify(owned));
      }

      function updateCount() {
        const total = figures.length;
        const have = Object.values(owned).filter(Boolean).length;
        document.getElementById("count").textContent =
          `${have} / ${total} collected`;
      }

      fetch("data/figures.json")
        .then((r) => r.json())
        .then((data) => {
          figures = data;

          figures.forEach((figure) => {
            const card = document.createElement("div");
            card.className = "card";

            card.innerHTML = `
            <div class="front">
              <img src="images/${figure.FigureID.toLowerCase()}.png" class="minifig-img">
              <div class="figure-name">${figure.FigureName}</div>
            </div>

            <div class="back">
              <div class="figure-name">${figure.FigureName}</div>
              <div>${figure.Series}</div>
              <div>${figure.Category}</div>
              <div>${figure.Year}</div>
              <div>${figure.Sets} Sets</div>
              <div>${figure.Rarity}</div>

              <div class="links">
                <a href="https://www.bricklink.com/v2/catalog/catalogitem.page?M=${figure.FigureID}"
                   target="_blank"
                   onclick="event.stopPropagation();">BrickLink</a>
                <a href="https://brickset.com/minifigs/${figure.FigureID}"
                   target="_blank"
                   onclick="event.stopPropagation();">BrickSet</a>
              </div>
            </div>
          `;

            if (owned[figure.FigureID]) {
              card.classList.add("owned");
            }

            card.onclick = () => {
              owned[figure.FigureID] = !owned[figure.FigureID];
              card.classList.toggle("owned");
              save();
              updateCount();
            };

            grid.appendChild(card);
          });

          updateCount();
        });
    </script>
  </body>
</html>
